<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Universal Embed</title>
<style>
  body {
    margin: 0;
    display: flex;
    justify-content: center;
    align-items: center;
    background: #111;
    height: 100vh;
    color: #fff;
    font-family: Arial, sans-serif;
  }
  iframe, audio, video {
    max-width: 90vw;
    max-height: 80vh;
    border: none;
    border-radius: 8px;
  }
  .fallback {
    text-align: center;
  }
  a {
    color: #1da1f2;
    text-decoration: none;
    font-size: 1.2em;
  }
</style>
</head>
<body>
<script>
const urlParam = new URLSearchParams(window.location.search).get('');
const body = document.body;

function createIframe(src) {
  const iframe = document.createElement('iframe');
  iframe.src = src;
  iframe.allow = "accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture";
  iframe.allowFullscreen = true;
  body.appendChild(iframe);
}

function createAudio(src) {
  const audio = document.createElement('audio');
  audio.controls = true;
  audio.src = src;
  body.appendChild(audio);
}

function fallbackLink(url) {
  const div = document.createElement('div');
  div.className = 'fallback';
  div.innerHTML = `Cannot embed this URL. <br><a href="${url}" target="_blank">Open Link</a>`;
  body.appendChild(div);
}

if (urlParam) {
  try {
    const url = decodeURIComponent(urlParam);

    // YouTube
    if (url.includes('youtube.com') || url.includes('youtu.be')) {
      const idMatch = url.match(/(?:v=|\/)([a-zA-Z0-9_-]{11})/);
      if (idMatch) createIframe(`https://www.youtube.com/embed/${idMatch[1]}?autoplay=0`);
      else fallbackLink(url);
    }
    // Vimeo
    else if (url.includes('vimeo.com')) {
      const idMatch = url.match(/vimeo.com\/(\d+)/);
      if (idMatch) createIframe(`https://player.vimeo.com/video/${idMatch[1]}`);
      else fallbackLink(url);
    }
    // SoundCloud
    else if (url.includes('soundcloud.com')) {
      createIframe(`https://w.soundcloud.com/player/?url=${encodeURIComponent(url)}&auto_play=false`);
    }
    // Generic video file
    else if(url.match(/\.(mp4|webm|ogg)$/)) {
      const video = document.createElement('video');
      video.controls = true;
      video.src = url;
      body.appendChild(video);
    }
    // Generic audio file
    else if(url.match(/\.(mp3|wav|ogg)$/)) {
      createAudio(url);
    }
    // Fallback
    else {
      createIframe(url);
    }
  } catch(e) {
    fallbackLink(urlParam);
  }
} else {
  body.innerHTML = `<div class="fallback">No URL provided. Use ?=LINK</div>`;
}
</script>
</body>
</html>
