<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Universal Embed</title>
<style>
  body { margin:0; display:flex; justify-content:center; align-items:center; height:100vh; background:#111; color:#fff; font-family:sans-serif; }
  iframe, video, audio { max-width:90vw; max-height:80vh; border:none; border-radius:8px; }
  .fallback { text-align:center; }
</style>
</head>
<body>
<div id="container">Loadingâ€¦</div>

<script>
const params = new URLSearchParams(window.location.search);
const url = params.get(''); // grab ?=URL
const container = document.getElementById('container');

function fallback(msg){
  container.innerHTML = `<div class="fallback">${msg}</div>`;
}

if(!url){
  fallback("No URL provided. Use ?=URL");
} else {
  try{
    const decoded = decodeURIComponent(url);

    // YouTube
    if(decoded.includes("youtube.com") || decoded.includes("youtu.be")){
      const match = decoded.match(/(?:v=|\/)([a-zA-Z0-9_-]{11})/);
      if(match){
        const id = match[1];
        const iframe = document.createElement('iframe');
        iframe.src = `https://www.youtube.com/embed/${id}`;
        iframe.allow = "accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture";
        iframe.allowFullscreen = true;
        container.innerHTML = '';
        container.appendChild(iframe);
      } else fallback("Invalid YouTube link.");
    }
    // Vimeo
    else if(decoded.includes("vimeo.com")){
      const match = decoded.match(/vimeo.com\/(\d+)/);
      if(match){
        const id = match[1];
        const iframe = document.createElement('iframe');
        iframe.src = `https://player.vimeo.com/video/${id}`;
        iframe.allowFullscreen = true;
        container.innerHTML = '';
        container.appendChild(iframe);
      } else fallback("Invalid Vimeo link.");
    }
    // SoundCloud
    else if(decoded.includes("soundcloud.com")){
      const iframe = document.createElement('iframe');
      iframe.src = `https://w.soundcloud.com/player/?url=${encodeURIComponent(decoded)}&auto_play=false`;
      iframe.allowFullscreen = true;
      container.innerHTML = '';
      container.appendChild(iframe);
    }
    // Direct video
    else if(decoded.match(/\.(mp4|webm|ogg)$/)){
      const video = document.createElement('video');
      video.controls = true;
      video.src = decoded;
      container.innerHTML = '';
      container.appendChild(video);
    }
    // Direct audio
    else if(decoded.match(/\.(mp3|wav|ogg)$/)){
      const audio = document.createElement('audio');
      audio.controls = true;
      audio.src = decoded;
      container.innerHTML = '';
      container.appendChild(audio);
    }
    // Fallback iframe
    else{
      const iframe = document.createElement('iframe');
      iframe.src = decoded;
      iframe.allowFullscreen = true;
      container.innerHTML = '';
      container.appendChild(iframe);
    }

  } catch(e){
    fallback("Error loading URL.");
    console.error(e);
  }
}
</script>
</body>
</html>
